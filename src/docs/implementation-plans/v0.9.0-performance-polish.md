# v0.9.0-alpha: Performance & Polish

**Target:** May 2026  
**Goal:** 98% feature parity, within 10% of Solid.js performance  
**Duration:** 3-4 weeks

## Implementation Rules

**CRITICAL - Must Follow:**

- One item per file
- Prototype-based classes
- Feature slice architecture
- Benchmark every optimization
- No premature optimization
- Profile before changing

## Features

### 1. Component Compilation ðŸŸ¡ CRITICAL

**Priority:** P0  
**Duration:** 2 weeks

**File Structure:**

```
src/compiler/component/
â”œâ”€â”€ index.ts
â”œâ”€â”€ component-compiler.ts       # Main compiler
â”œâ”€â”€ component-compiler.types.ts
â”œâ”€â”€ inline-optimizer.ts         # Inline component logic
â”œâ”€â”€ memoization.ts              # Component memoization
â””â”€â”€ README.md
```

**Implementation:**

- Remove function call overhead
- Inline component logic where possible
- Memoize pure components
- Hoist static computations
- Expected: 30% faster rendering

**Acceptance Criteria:**

- [ ] Components inlined correctly
- [ ] Memoization works
- [ ] No semantic changes
- [ ] 25-30% faster benchmarks
- [ ] Tests pass (all existing)
- [ ] Source maps accurate

---

### 2. Static DOM Hoisting ðŸŸ¡ CRITICAL

**Priority:** P0  
**Duration:** 1 week

**File Structure:**

```
src/compiler/hoisting/
â”œâ”€â”€ index.ts
â”œâ”€â”€ static-hoisting.ts          # Static content detection
â”œâ”€â”€ dom-cache.ts                # DOM element cache
â””â”€â”€ README.md
```

**Implementation:**

- Detect static DOM elements
- Create once, reuse across renders
- Clone instead of recreate
- Expected: 20% faster initial render

**Acceptance Criteria:**

- [ ] Static elements detected
- [ ] Elements cloned correctly
- [ ] Dynamic parts still reactive
- [ ] 15-20% faster initial render
- [ ] Tests pass (all existing)
- [ ] Memory usage acceptable

---

### 3. Reactive Scope Optimization ðŸŸ¡ CRITICAL

**Priority:** P1  
**Duration:** 1 week

**File Structure:**

```
src/compiler/reactive/
â”œâ”€â”€ index.ts
â”œâ”€â”€ scope-optimizer.ts          # Optimize reactive boundaries
â”œâ”€â”€ effect-scheduler.ts         # Schedule effect updates
â””â”€â”€ README.md
```

**Implementation:**

- Prune unnecessary reactive boundaries
- Batch effect updates
- Minimize tracking overhead
- Expected: 10-15% memory reduction

**Acceptance Criteria:**

- [ ] Unnecessary boundaries removed
- [ ] Effects batched correctly
- [ ] Reactivity still works
- [ ] 10-15% memory reduction
- [ ] Tests pass (all existing)
- [ ] No regressions

---

### 4. HMR State Preservation ðŸŸ¡ CRITICAL

**Priority:** P1  
**Duration:** 1 week

**File Structure:**

```
src/dev/hmr/
â”œâ”€â”€ index.ts
â”œâ”€â”€ state-preserver.ts          # Preserve signal state
â”œâ”€â”€ component-differ.ts         # Diff component trees
â”œâ”€â”€ signal-resubscribe.ts       # Re-subscribe signals
â””â”€â”€ README.md
```

**Implementation:**

- Preserve signal values across reloads
- Diff and patch component trees
- Re-subscribe signals to new components
- Store state retention

**Acceptance Criteria:**

- [ ] Signals preserved
- [ ] Store state retained
- [ ] Components re-rendered correctly
- [ ] No memory leaks
- [ ] Tests pass (15+ cases)
- [ ] Works with Vite HMR

---

### 5. Bundle Size Reduction ðŸŸ¡ OPTIMIZATION

**Priority:** P2  
**Duration:** 1 week

**File Structure:**

```
src/build/optimization/
â”œâ”€â”€ index.ts
â”œâ”€â”€ tree-shaker.ts              # Enhanced tree shaking
â”œâ”€â”€ dead-code-eliminator.ts     # Improved DCE
â””â”€â”€ README.md
```

**Implementation:**

- Enhanced tree shaking
- More aggressive dead code elimination
- Target: 9.71KB â†’ 8KB minified

**Acceptance Criteria:**

- [ ] Bundle size reduced 15-20%
- [ ] All features still work
- [ ] Tests pass (all existing)
- [ ] No runtime errors
- [ ] Gzipped: 2.53KB â†’ 2.2KB

---

## Performance Targets

| Metric                     | Current | Target | Gap           |
| -------------------------- | ------- | ------ | ------------- |
| Initial render (1000 rows) | ~45ms   | ~30ms  | 33% faster    |
| Update (1 row)             | ~0.5ms  | ~0.4ms | 20% faster    |
| Memory (1000 components)   | ~3.5MB  | ~3MB   | 15% reduction |
| Bundle size (minified)     | 9.71KB  | 8KB    | 18% reduction |
| Bundle size (gzipped)      | 2.53KB  | 2.2KB  | 13% reduction |

## Benchmarking

**Frameworks to Compare:**

- Solid.js v1.8
- React 18
- Vue 3
- Svelte 5

**Benchmarks:**

- js-framework-benchmark
- Real-world app scenarios
- Memory profiling
- Bundle size analysis

## Testing Strategy

**Performance Tests:**

- Before/after comparisons
- Regression detection
- Memory leak detection
- Bundle size tracking

**Compatibility Tests:**

- All existing tests pass
- No semantic changes
- Source maps work
- HMR works

## Migration Guide

**Breaking Changes:** None  
**Performance Gains:** Automatic  
**Opt-out:** Via build config if needed

## Documentation

- [ ] Performance guide
- [ ] Optimization best practices
- [ ] Benchmark results
- [ ] Profiling guide
- [ ] Memory optimization
- [ ] Bundle size optimization
